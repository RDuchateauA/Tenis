<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Diario de Partidos de Tenis</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="app-header">
    <h1>üéæ Diario de Partidos de Tenis</h1>
    <div class="actions">
      <button id="btn-add">+ Partido</button>
      <button id="btn-export-json">Exportar JSON</button>
      <button id="btn-export-csv">Exportar CSV</button>
      <label class="import-label">
        Importar JSON
        <input type="file" id="file-import-json" accept=".json" hidden>
      </label>
      <label class="import-label">
        Importar CSV
        <input type="file" id="file-import-csv" accept=".csv" hidden>
      </label>
    </div>
  </header>

  <section class="filters">
    <div class="filter-row">
      <input id="search" placeholder="Buscar por rival, notas o tags‚Ä¶" />
      <select id="f-superficie">
        <option value="">Todas las superficies</option>
        <option value="Dura">Dura</option>
        <option value="Arcilla">Arcilla</option>
        <option value="Pasto">Pasto</option>
        <option value="Sint√©tica">Sint√©tica</option>
      </select>
      <select id="f-resultado">
        <option value="">Todos los resultados</option>
        <option value="W">Victoria</option>
        <option value="L">Derrota</option>
        <option value="RET">Retiro</option>
      </select>
      <input id="f-desde" type="date" />
      <input id="f-hasta" type="date" />
      <button id="btn-clear-filters" title="Limpiar filtros">Limpiar</button>
    </div>
  </section>

  <section class="stats" id="stats">
    <div class="card">
      <div class="kpi-label">Win rate global</div>
      <div class="kpi-value" id="kpi-winrate">‚Äî</div>
    </div>
    <div class="card">
      <div class="kpi-label">Win rate por superficie</div>
      <div class="kpi-value small" id="kpi-superficie">‚Äî</div>
    </div>
    <div class="card">
      <div class="kpi-label">Racha actual</div>
      <div class="kpi-value" id="kpi-streak">‚Äî</div>
    </div>
    <div class="card">
      <div class="kpi-label">Duraci√≥n prom.</div>
      <div class="kpi-value" id="kpi-duracion">‚Äî</div>
    </div>
    <div class="card">
      <div class="kpi-label">RPE promedio</div>
      <div class="kpi-value" id="kpi-rpe">‚Äî</div>
    </div>
  </section>

  <section class="list">
    <table id="tbl">
      <thead>
        <tr>
          <th>Fecha</th>
          <th>Formato</th>
          <th>Rival</th>
          <th>Superficie</th>
          <th>Sets</th>
          <th>Resultado</th>
          <th>Duraci√≥n</th>
          <th>RPE</th>
          <th>Notas/Tags</th>
          <th></th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>
  </section>

  <dialog id="dlg">
    <form id="frm" method="dialog">
      <h2 id="dlg-title">Nuevo partido</h2>
      <div class="grid">
        <label>Fecha
          <input type="date" id="fecha" required />
        </label>
        <label>Hora inicio (opcional)
          <input type="time" id="hora_inicio" />
        </label>
        <label>Duraci√≥n (min)
          <input type="number" id="duracion_min" min="0" step="1" placeholder="Ej. 90" />
        </label>
        <label>Rival
          <input type="text" id="rival" placeholder="Nombre del rival" />
        </label>
        <label>Superficie
          <select id="superficie">
            <option value="">‚Äî</option>
            <option>Dura</option>
            <option>Arcilla</option>
            <option>Pasto</option>
            <option>Sint√©tica</option>
          </select>
        </label>
        <label>Ubicaci√≥n (opcional)
          <input type="text" id="ubicacion" placeholder="Club, ciudad‚Ä¶" />
        </label>
        <label>Formato
          <select id="formato">
            <option value="BO3_TB">Mejor de 3 sets, TB a 6‚Äì6 (est√°ndar)</option>
            <option value="BO3_STB">Mejor de 3, super tie-break (10) como 3er set</option>
            <option value="PRO8">Pro set a 8 juegos (australiano)</option>
            <option value="SET6">Set √∫nico a 6 juegos</option>
          </select>
        </label>
        <label>RPE (1‚Äì10)
          <input type="number" id="rpe" min="1" max="10" step="1" />
        </label>
        <label>Tags
          <input type="text" id="tags" placeholder="torneo, amistoso, clase‚Ä¶" />
        </label>
      </div>

      <fieldset class="sets">
        <legend>Marcador por set</legend>
        <div id="sets-container"></div>
        <button type="button" id="btn-add-set">+ Set</button>
        <button type="button" id="btn-clear-sets">Limpiar sets</button>
      </fieldset>

      <label>Notas
        <textarea id="notas" rows="3" placeholder="Observaciones, sensaciones, puntos clave‚Ä¶"></textarea>
      </label>

      <menu class="dialog-actions">
        <button type="reset" id="btn-cancel">Cancelar</button>
        <button id="btn-save" value="save" class="primary" type="button">Guardar</button>
      </menu>
    </form>
  </dialog>

  <footer class="footer">
    <span>Hecho para ti ‚Ä¢ 2025-08-16</span>
    <span class="version">v0.1.1</span>
    <button id="btn-novedades" class="linklike">Novedades</button>
  </footer>

  <dialog id="dlg-novedades">
    <h3>Novedades v0.1.1</h3>
    <ul>
      <li>MVP con registro r√°pido, filtros y 5 KPIs clave.</li>
      <li>Fix: bot√≥n Guardar m√°s confiable (evita submit impl√≠cito) + soporte Enter; formatos: BO3 con TB, BO3 con Super TB, Pro set a 8, Set √∫nico a 6.</li>
      <li>Importaci√≥n/Exportaci√≥n JSON y CSV.</li>
      <li>Auto-guardado local, edici√≥n y borrado por fila.</li>
      <li>Interfaz en espa√±ol.</li>
    </ul>
    <p>Backlog (pr√≥ximas versiones): dobles, m√©tricas punto a punto, estado f√≠sico (isquios/muslos, sue√±o, pesas), PWA instalable, plantillas y atajos inteligentes.</p>
    <menu class="dialog-actions">
      <button id="btn-close-nov">Cerrar</button>
    </menu>
  </dialog>

  <script>const APP_VERSION = "v0.1.1";</script>
  <script src="script.js"></script>
</body>
</html>
